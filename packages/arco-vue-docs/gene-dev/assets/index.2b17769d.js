var j=Object.defineProperty,F=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var k=(e,s,o)=>s in e?j(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,m=(e,s)=>{for(var o in s||(s={}))A.call(s,o)&&k(e,o,s[o]);if(M)for(var o of M(s))N.call(s,o)&&k(e,o,s[o]);return e},y=(e,s)=>F(e,T(s));import{d as w,ef as P,eg as V,eh as z,ei as G,ej as q,ek as Y,h as S,el as D,em as J,en as K,k as Q,r as c,o as r,l as C,n as g,d$ as I,c as p,e9 as _,e as R,a as h,w as W,eo as X,ep as $,eq as Z,e1 as x,er as ee,es as se,e4 as oe,et as ne,eu as te,ev as b,ew as ae,g as le}from"./index.9c61ea88.js";import{I as ie}from"./index.5bc6c633.js";const re=w({name:"Message",components:{AIconHover:P,IconInfoCircleFill:ie,IconCheckCircleFill:V,IconExclamationCircleFill:z,IconCloseCircleFill:G,IconClose:q,IconLoading:Y},props:{type:{type:String,default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!0},duration:{type:Number,default:3e3},resetOnUpdate:{type:Boolean,default:!1},resetOnHover:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:s}){const o=S("message");let i=0;const l=()=>{s("close")},n=()=>{e.duration>0&&(i=window.setTimeout(l,e.duration))},t=()=>{i&&(window.clearTimeout(i),i=0)};return D(()=>{n()}),J(()=>{e.resetOnUpdate&&(t(),n())}),K(()=>{t()}),{handleMouseEnter:()=>{e.resetOnHover&&t()},handleMouseLeave:()=>{e.resetOnHover&&n()},prefixCls:o,handleClose:l}}});function ce(e,s,o,i,l,n){const t=c("icon-info-circle-fill"),a=c("icon-check-circle-fill"),u=c("icon-exclamation-circle-fill"),B=c("icon-close-circle-fill"),L=c("icon-loading"),U=c("icon-close"),H=c("a-icon-hover");return r(),C("li",{role:"alert",class:g([e.prefixCls,`${e.prefixCls}-${e.type}`,{[`${e.prefixCls}-closable`]:e.closable}]),onMouseenter:s[1]||(s[1]=(...f)=>e.handleMouseEnter&&e.handleMouseEnter(...f)),onMouseleave:s[2]||(s[2]=(...f)=>e.handleMouseLeave&&e.handleMouseLeave(...f))},[e.showIcon&&!(e.type==="normal"&&!e.$slots.icon)?(r(),C("span",{key:0,class:g(`${e.prefixCls}-icon`)},[I(e.$slots,"icon",{},()=>[e.type==="info"?(r(),p(t,{key:0})):e.type==="success"?(r(),p(a,{key:1})):e.type==="warning"?(r(),p(u,{key:2})):e.type==="error"?(r(),p(B,{key:3})):e.type==="loading"?(r(),p(L,{key:4})):_("v-if",!0)])],2)):_("v-if",!0),R("span",{class:g(`${e.prefixCls}-content`)},[I(e.$slots,"default")],2),e.closable?(r(),C("span",{key:1,class:g(`${e.prefixCls}-close-btn`),onClick:s[0]||(s[0]=(...f)=>e.handleClose&&e.handleClose(...f))},[h(H,null,{default:W(()=>[h(U)]),_:1})],2)):_("v-if",!0)],34)}var ue=Q(re,[["render",ce]]);function de(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!x(e)}var fe=w({name:"MessageList",props:{messages:{type:Array,default:()=>[]},position:{type:String,default:"top"}},emits:["close","afterClose"],setup(e,s){const o=S("message-list"),{zIndex:i}=X("message",{runOnMounted:!0});return()=>{let l;return h(Z,{class:[o,`${o}-${e.position}`],name:"fade-message",tag:"ul",style:{zIndex:i.value},onAfterLeave:()=>s.emit("afterClose")},de(l=e.messages.map(n=>{const t={default:$(n.content),icon:$(n.icon)};return h(ue,{key:n.id,type:n.type,duration:n.duration,closable:n.closable,resetOnUpdate:n.resetOnUpdate,resetOnHover:n.resetOnHover,onClose:()=>s.emit("close",n.id)},t)}))?l:{default:()=>[l]})}}});class me{constructor(s,o){this.messageCount=0,this.add=n=>{var t;this.messageCount++;const a=(t=n.id)!=null?t:`__arco_message_${this.messageCount}`;if(this.messageIds.has(a))return this.update(a,n);const u=oe(m({id:a},n));return this.messages.value.push(u),this.messageIds.add(a),{close:()=>this.remove(a)}},this.update=(n,t)=>{for(let a=0;a<this.messages.value.length;a++)if(this.messages.value[a].id===n){const u=!ne(t.duration);Object.assign(this.messages.value[a],y(m({},t),{id:n,resetOnUpdate:u}));break}return{close:()=>this.remove(n)}},this.remove=n=>{for(let t=0;t<this.messages.value.length;t++){const a=this.messages.value[t];if(a.id===n){te(a.onClose)&&a.onClose(n),this.messages.value.splice(t,1),this.messageIds.delete(n);break}}},this.clear=()=>{this.messages.value.splice(0)},this.destroy=()=>{this.messages.value.length===0&&this.container&&(b(null,this.container),document.body.removeChild(this.container),this.container=null,d[this.position]=void 0)};const{position:i="top"}=s;this.container=ae("message"),this.messageIds=new Set,this.messages=le([]),this.position=i;const l=h(fe,{messages:this.messages.value,position:i,onClose:this.remove,onAfterClose:this.destroy});(o!=null?o:O._context)&&(l.appContext=o!=null?o:O._context),b(l,this.container),document.body.appendChild(this.container)}}const d={},E=[...ee,"loading","normal"],v=E.reduce((e,s)=>(e[s]=(o,i)=>{se(o)&&(o={content:o});const l=m({type:s},o),{position:n="top"}=l;return d[n]||(d[n]=new me(l,i)),d[n].add(l)},e),{});v.clear=e=>{var s;e?(s=d[e])==null||s.clear():Object.values(d).forEach(o=>o==null?void 0:o.clear())};const O=y(m({},v),{install:e=>{const s={clear:v.clear};for(const o of E)s[o]=(i,l=e._context)=>v[o](i,l);e.config.globalProperties.$message=s},_context:null});export{O as M};
