var Ae=Object.defineProperty,Ie=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ye=(e,o,l)=>o in e?Ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,S=(e,o)=>{for(var l in o||(o={}))Ne.call(o,l)&&ye(e,l,o[l]);if(pe)for(var l of pe(o))je.call(o,l)&&ye(e,l,o[l]);return e},x=(e,o)=>Ie(e,Le(o));var W=(e,o,l)=>new Promise((m,r)=>{var a=s=>{try{f(l.next(s))}catch(n){r(n)}},u=s=>{try{f(l.throw(s))}catch(n){r(n)}},f=s=>s.done?m(s.value):Promise.resolve(s.value).then(a,u);f((l=l.apply(e,o)).next())});import{g as y,f0 as X,f1 as ce,d as Ve,f2 as Fe,f3 as Re,ef as ze,ej as Ke,eg as Ye,eh as Ge,ei as He,eF as Ue,h as We,eU as Xe,i as D,f4 as qe,eo as Je,f5 as Qe,el as Ze,f6 as _e,eP as xe,e$ as Ce,j as be,eu as R,f7 as ge,eL as ke,f8 as eo,f9 as oo,k as lo,r as P,o as d,c as E,w as I,fa as no,fb as ee,l as A,m as oe,a as L,eR as he,n as B,p as le,fc as ne,e9 as p,e as te,ey as we,d$ as ae,b as se,e5 as ie,er as to,e2 as ao,e3 as so,ew as io,ep as re,fd as ro,ev as Be,eC as uo}from"./index.9c61ea88.js";import{I as fo}from"./index.5bc6c633.js";const co=({modalRef:e,wrapperRef:o,draggable:l,alignCenter:m})=>{const r=y(!1),a=y([0,0]),u=y([0,0]),f=y(),s=y([0,0]),n=y([0,0]),c=()=>{var i,T,O;if(o.value&&e.value){const{top:k,left:h}=o.value.getBoundingClientRect(),{clientWidth:z,clientHeight:K}=o.value,{top:N,left:Y,width:j,height:V}=e.value.getBoundingClientRect(),$=m.value?0:(i=e.value)==null?void 0:i.offsetTop,C=Y-h,G=N-k-$;(C!==((T=u.value)==null?void 0:T[0])||G!==((O=u.value)==null?void 0:O[1]))&&(u.value=[C,G]);const F=z>j?z-j:0,H=K>V?K-V-$:0;(F!==n.value[0]||H!==n.value[1])&&(n.value=[F,H]),$&&(s.value=[0,0-$])}},v=i=>{l.value&&(i.preventDefault(),r.value=!0,c(),a.value=[i.x,i.y],X(window,"mousemove",b),X(window,"mouseup",g),X(window,"contextmenu",g))},b=i=>{if(r.value){const T=i.x-a.value[0],O=i.y-a.value[1];let k=u.value[0]+T,h=u.value[1]+O;k<s.value[0]&&(k=s.value[0]),k>n.value[0]&&(k=n.value[0]),h<s.value[1]&&(h=s.value[1]),h>n.value[1]&&(h=n.value[1]),f.value=[k,h]}},g=()=>{r.value=!1,ce(window,"mousemove",b),ce(window,"mouseup",g)};return{position:f,handleMoveDown:v}};var mo=Ve({name:"Modal",components:{ClientOnly:Fe,ArcoButton:Re,IconHover:ze,IconClose:Ke,IconInfoCircleFill:fo,IconCheckCircleFill:Ye,IconExclamationCircleFill:Ge,IconCloseCircleFill:He},inheritAttrs:!1,props:{visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!1},width:{type:[Number,String]},top:{type:[Number,String]},mask:{type:Boolean,default:!0},title:{type:String},titleAlign:{type:String,default:"center"},alignCenter:{type:Boolean,default:!0},unmountOnClose:Boolean,maskClosable:{type:Boolean,default:!0},hideCancel:{type:Boolean,default:!1},simple:{type:Boolean,default:e=>e.notice},closable:{type:Boolean,default:!0},okText:String,cancelText:String,okLoading:{type:Boolean,default:!1},okButtonProps:{type:Object},cancelButtonProps:{type:Object},footer:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},popupContainer:{type:[String,Object],default:"body"},maskStyle:{type:Object},modalClass:{type:[String,Array]},modalStyle:{type:Object},onBeforeOk:{type:Function},onBeforeCancel:{type:Function},escToClose:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},maskAnimationName:{type:String,default:e=>e.fullscreen?"fade-in-standard":"fade-modal"},modalAnimationName:{type:String,default:e=>e.fullscreen?"zoom-in":"zoom-modal"},bodyClass:{type:[String,Array]},bodyStyle:{type:[String,Object,Array]},messageType:{type:String},hideTitle:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,ok:e=>!0,cancel:e=>!0,open:()=>!0,close:()=>!0,beforeOpen:()=>!0,beforeClose:()=>!0},setup(e,{emit:o}){const{fullscreen:l,popupContainer:m,alignCenter:r}=Ue(e),a=We("modal"),{t:u}=Xe(),f=y(),s=y(),n=y(e.defaultVisible),c=D(()=>{var t;return(t=e.visible)!=null?t:n.value}),v=y(!1),b=D(()=>e.okLoading||v.value),g=D(()=>e.draggable&&!e.fullscreen),{teleportContainer:i,containerRef:T}=qe({popupContainer:m,visible:c}),O=y(c.value),k=D(()=>e.okText||u("modal.okText")),h=D(()=>e.cancelText||u("modal.cancelText")),{zIndex:z,isLastDialog:K}=Je("dialog",{visible:c});let N=!1;const Y=t=>{e.escToClose&&t.key===oo.ESC&&K()&&J(t)},j=()=>{e.escToClose&&!N&&(N=!0,X(document.documentElement,"keydown",Y))},V=()=>{N=!1,ce(document.documentElement,"keydown",Y)};let $=0;const{position:C,handleMoveDown:G}=co({wrapperRef:f,modalRef:s,draggable:g,alignCenter:r}),F=()=>{$++,v.value&&(v.value=!1),n.value=!1,o("update:visible",!1)},H=t=>W(this,null,function*(){const w=$,U=yield new Promise(Z=>W(this,null,function*(){var ve;if(R(e.onBeforeOk)){let M=e.onBeforeOk((_=!0)=>Z(_));if((ge(M)||!ke(M))&&(v.value=!0),ge(M))try{M=(ve=yield M)!=null?ve:!0}catch(_){throw M=!1,_}ke(M)&&Z(M)}else Z(!0)}));w===$&&(U?(o("ok",t),F()):v.value&&(v.value=!1))}),J=t=>{var w;let U=!0;R(e.onBeforeCancel)&&(U=(w=e.onBeforeCancel())!=null?w:!1),U&&(o("cancel",t),F())},Q=y(!1),Oe=t=>{t.target===f.value&&(Q.value=!0)},$e=t=>{e.mask&&e.maskClosable&&Q.value&&J(t)},Me=()=>{c.value&&(!eo(f.value,document.activeElement)&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o("open"))},Se=()=>{c.value||(g.value&&(C.value=void 0),O.value=!1,me(),o("close"))},{setOverflowHidden:de,resetOverflow:me}=Qe(T);Ze(()=>{T.value=_e(e.popupContainer),c.value&&(de(),e.escToClose&&j())}),xe(()=>{me(),V()}),Ce(c,t=>{n.value!==t&&(n.value=t),t?(o("beforeOpen"),O.value=!0,Q.value=!1,de(),j()):(o("beforeClose"),V())}),Ce(l,()=>{C.value&&(C.value=void 0)});const De=D(()=>[`${a}-wrapper`,{[`${a}-wrapper-align-center`]:e.alignCenter&&!e.fullscreen,[`${a}-wrapper-moved`]:Boolean(C.value)}]),Pe=D(()=>[`${a}`,e.modalClass,{[`${a}-simple`]:e.simple,[`${a}-draggable`]:g.value,[`${a}-fullscreen`]:e.fullscreen}]),Ee=D(()=>{var t;const w=S({},(t=e.modalStyle)!=null?t:{});return e.width&&!e.fullscreen&&(w.width=be(e.width)?`${e.width}px`:e.width),!e.alignCenter&&e.top&&(w.top=be(e.top)?`${e.top}px`:e.top),C.value&&(w.transform=`translate(${C.value[0]}px, ${C.value[1]}px)`),w});return{prefixCls:a,mounted:O,computedVisible:c,containerRef:T,wrapperRef:f,mergedModalStyle:Ee,okDisplayText:k,cancelDisplayText:h,zIndex:z,handleOk:H,handleCancel:J,handleMaskClick:$e,handleMaskMouseDown:Oe,handleOpen:Me,handleClose:Se,mergedOkLoading:b,modalRef:s,wrapperCls:De,modalCls:Pe,teleportContainer:i,handleMoveDown:G}}});function vo(e,o,l,m,r,a){const u=P("icon-info-circle-fill"),f=P("icon-check-circle-fill"),s=P("icon-exclamation-circle-fill"),n=P("icon-close-circle-fill"),c=P("icon-close"),v=P("icon-hover"),b=P("arco-button"),g=P("client-only");return d(),E(g,null,{default:I(()=>[(d(),E(no,{to:e.teleportContainer,disabled:!e.renderToBody},[!e.unmountOnClose||e.computedVisible||e.mounted?ee((d(),A("div",oe({key:0,class:`${e.prefixCls}-container`,style:{zIndex:e.zIndex}},e.$attrs),[L(he,{name:e.maskAnimationName,appear:""},{default:I(()=>[e.mask?ee((d(),A("div",{key:0,ref:"maskRef",class:B(`${e.prefixCls}-mask`),style:le(e.maskStyle)},null,6)),[[ne,e.computedVisible]]):p("v-if",!0)]),_:1},8,["name"]),te("div",{ref:"wrapperRef",class:B(e.wrapperCls),onClick:o[2]||(o[2]=we((...i)=>e.handleMaskClick&&e.handleMaskClick(...i),["self"])),onMousedown:o[3]||(o[3]=we((...i)=>e.handleMaskMouseDown&&e.handleMaskMouseDown(...i),["self"]))},[L(he,{name:e.modalAnimationName,appear:"",onAfterEnter:e.handleOpen,onAfterLeave:e.handleClose,persisted:""},{default:I(()=>[ee(te("div",{ref:"modalRef",class:B(e.modalCls),style:le(e.mergedModalStyle)},[!e.hideTitle&&(e.$slots.title||e.title||e.closable)?(d(),A("div",{key:0,class:B(`${e.prefixCls}-header`),onMousedown:o[1]||(o[1]=(...i)=>e.handleMoveDown&&e.handleMoveDown(...i))},[e.$slots.title||e.title?(d(),A("div",{key:0,class:B([`${e.prefixCls}-title`,`${e.prefixCls}-title-align-${e.titleAlign}`])},[e.messageType?(d(),A("div",{key:0,class:B(`${e.prefixCls}-title-icon`)},[e.messageType==="info"?(d(),E(u,{key:0})):p("v-if",!0),e.messageType==="success"?(d(),E(f,{key:1})):p("v-if",!0),e.messageType==="warning"?(d(),E(s,{key:2})):p("v-if",!0),e.messageType==="error"?(d(),E(n,{key:3})):p("v-if",!0)],2)):p("v-if",!0),ae(e.$slots,"title",{},()=>[se(ie(e.title),1)])],2)):p("v-if",!0),!e.simple&&e.closable?(d(),A("div",{key:1,tabindex:"-1",role:"button","aria-label":"Close",class:B(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...i)=>e.handleCancel&&e.handleCancel(...i))},[L(v,null,{default:I(()=>[L(c)]),_:1})],2)):p("v-if",!0)],34)):p("v-if",!0),te("div",{class:B([`${e.prefixCls}-body`,e.bodyClass]),style:le(e.bodyStyle)},[ae(e.$slots,"default")],6),e.footer?(d(),A("div",{key:1,class:B(`${e.prefixCls}-footer`)},[ae(e.$slots,"footer",{},()=>[e.hideCancel?p("v-if",!0):(d(),E(b,oe({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:I(()=>[se(ie(e.cancelDisplayText),1)]),_:1},16,["onClick"])),L(b,oe({type:"primary"},e.okButtonProps,{loading:e.mergedOkLoading,onClick:e.handleOk}),{default:I(()=>[se(ie(e.okDisplayText),1)]),_:1},16,["loading","onClick"])])],2)):p("v-if",!0)],6),[[ne,e.computedVisible]])]),_:3},8,["name","onAfterEnter","onAfterLeave"])],34)],16)),[[ne,e.computedVisible||e.mounted]]):p("v-if",!0)],8,["to","disabled"]))]),_:3})}var q=lo(mo,[["render",vo]]);const ue=(e,o)=>{let l=io("modal");const m=()=>{n.component&&(n.component.props.visible=!1),R(e.onOk)&&e.onOk()},r=()=>{n.component&&(n.component.props.visible=!1),R(e.onCancel)&&e.onCancel()},a=()=>W(void 0,null,function*(){yield uo(),l&&(Be(null,l),document.body.removeChild(l)),l=null,R(e.onClose)&&e.onClose()}),u=()=>{n.component&&(n.component.props.visible=!1)},f=c=>{n.component&&Object.entries(c).forEach(([v,b])=>{n.component.props[v]=b})},n=L(q,x(S(S({},{visible:!0,renderToBody:!1,unmountOnClose:!0,onOk:m,onCancel:r,onClose:a}),ro(e,["content","title","footer","visible","unmountOnClose","onOk","onCancel","onClose"])),{footer:typeof e.footer=="boolean"?e.footer:void 0}),{default:re(e.content),title:re(e.title),footer:typeof e.footer!="boolean"?re(e.footer):void 0});return(o!=null?o:Te._context)&&(n.appContext=o!=null?o:Te._context),Be(n,l),document.body.appendChild(l),{close:u,update:f}},fe=S({open:ue,confirm:(e,o)=>{const l=S({simple:!0,messageType:"warning"},e);return ue(l,o)}},to.reduce((e,o)=>(e[o]=(l,m)=>{const r=S({simple:!0,hideCancel:!0,messageType:o},l);return ue(r,m)},e),{})),Te=Object.assign(q,x(S({},fe),{install:(e,o)=>{ao(e,o);const l=so(o);e.component(l+q.name,q);const m={};for(const r of Object.keys(fe))m[r]=(a,u=e._context)=>fe[r](a,u);e.config.globalProperties.$modal=m},_context:null}));export{Te as M};
